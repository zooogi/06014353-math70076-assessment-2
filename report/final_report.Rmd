---
title: 'Replication Report: Empathy, Mental Health, and Burnout in Medical Students'
author: "CID:06014353"
date: "`r Sys.Date()`"
output:
  pdf_document:
    latex_engine: xelatex
    number_sections: true            
    toc: true                        
    toc_depth: 2                      
    fig_caption: true                
    keep_tex: true                   
    pandoc_args: ["--variable=fontsize:10pt"]  
    df_print: paged
knitr:
  root.dir: ..
  opts_chunk:
    echo: false      
    message: false  
    warning: false   
bibliography: "references.bib"
link-citations: true
header-includes:
  - \usepackage{booktabs}
  - \usepackage{longtable}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage[table]{xcolor}
  - \usepackage{wrapfig}
  - \usepackage{float}
  - \usepackage{colortbl}
  - \usepackage{pdflscape}
  - \usepackage{fontspec}
---

```{r setup, include=FALSE,tidy=TRUE}
knitr::opts_chunk$set(echo = FALSE)
```
```{r load packages, include=FALSE}
library(here)
library(dplyr)
library(knitr)
library(kableExtra)
library(stringr)
library(tidyverse)
library(ggplot2)
library(stringr)
library(forcats)
```
```{r load table and data, include=FALSE}
final_table1 <- read_csv(here("figures", "table1_descriptive_stats.csv"),show_col_types = FALSE)
final_table2 <- read_csv(here("figures", "table2_replication.csv"),show_col_types = FALSE)
final_table3 <- read_csv(here("figures", "table3_replication.csv"),show_col_types = FALSE)
final_eta <- read_csv(here("figures", "cesd_prevalence_by_year.csv"))
df_raw <- read_csv("data/raw/Data Carrard et al. 2022 MedTeach.csv",show_col_types = FALSE)
df_cesd<- readRDS("data/processed/derived_data.rds")
df_clean <- readRDS("data/processed/cleaned_data.rds")
```

# Background and Aim
This report attempts to replicate a study by Carrard et al. (2021), published in *Medical Teacher* (@Carrard02122022). The core focus of the study is the relationship between medical students’ empathy (cognitive, affective, and behavioral dimensions) and their mental health (depression, anxiety) as well as professional burnout. The original study used cross-sectional survey data from 886 medical students in years 1 to 6 at a Swiss medical school. Relevant variables were measured using self-report questionnaires, and linear regression was employed to analyze the relationships between empathy, mental health, and burnout. The replication aims to fully reproduce the key results of the original article (including Table 2 and Table 3) using R software and the publicly available original dataset on the Zenodo platform (https://zenodo.org/records/5702895#.Y8OraNJBwUE), in order to assess the reproducibility and robustness of the findings.

# Methods
The data used in this replication come from the original study’s publicly available questionnaire dataset on the Zenodo platform. It includes self-reported data from 886 Swiss medical students, covering empathy (JSPE-S, QCAE, AMSP, GERT-S) across cognitive, affective, and behavioral dimensions, mental health (CES-D, STAI), and professional burnout (MBI). Data preprocessing strictly followed the original study: individuals identifying as non-binary (n = 5) were excluded. Gender and year variables were converted into factors for regression modeling. A binary variable indicating “depression risk” was created based on CES-D gender-specific cut-offs (male $\ge 16$, female $\ge 21$).

The main analysis has two parts: first, 10 linear regression models were built using year and gender as predictors to examine their effects on mental health and burnout dimensions; second, 25 models were constructed to test the predictive effects of five empathy dimensions on five mental health and burnout outcomes. All models were built using the `lm()` function, with formulas generated in batch via `reformulate()`.

To ensure comparability with the original results, standardized coefficients ($\beta$) were computed using `parameters::standardize_parameters()` with `method = "basic"`, applying the following transformation:
\[
\beta^* = \hat{\beta} \cdot \frac{\text{SD}(x)}{\text{SD}(y)}
\]
In addition, partial $\eta^2$ (`effectsize::eta_squared()`), standard errors, F-statistics, and R² were extracted to fully reproduce the original result structure.

As supplementary analyses, two key descriptive tests from the original Results section were also replicated: (1) a chi-square test comparing the sample’s gender distribution to the school’s full student body to assess representativeness. The null hypothesis assumed no difference between sample and population gender distribution; (2) the proportion of students at clinical risk of depression, based on CES-D cut-offs, was calculated to verify key proportions reported in the article.

# Results
The table below presents the descriptive statistics obtained in this replication. The reported variables closely match those in Table 1 of the original study, indicating that data loading and processing were accurate. Due to the large number of original variables, this report shows only key demographic and mental health variables; the full list can be found in the appendix (Table3) or figures folder. In addition, I replicated a supplementary descriptive analysis from the original study: a chi-square test comparing the sample’s gender distribution with that of the full medical school population. The result showed no significant difference ($\chi^2 = 1.24$, df = 1, $p = 0.265$), consistent with the original, supporting the representativeness of the sample.

```{r warning=FALSE,message=FALSE}
final_table1_clean <- final_table1 %>%
  filter(!str_starts(Variable, "glang")) %>%
  filter(!str_starts(Variable, "Consulted psy last year")) %>%
  filter(!str_starts(Variable, "Has")) %>%
  filter(!str_starts(Variable, "Mother tongue")) %>%
  filter(
    !Variable %in% c(
      "health",
      "stud_h",
      "age"
      )) %>%
  
  mutate(
    `Mean (SD)` = ifelse(is.na(`Mean (SD)`), "-", `Mean (SD)`),
    Percent      = ifelse(is.na(Percent), "-", Percent)
  ) %>%
  
  mutate(
    Variable = case_when(
      Variable == "stai_t"  ~ "Anxiety", 
      Variable == "cesd" ~ "Depressive symptoms",
      Variable == "amsp"  ~ "AMSP",
      Variable == "erec_mean"  ~ "GERT-S", 
      Variable == "mbi_cy" ~ "Cynicism",
      Variable == "mbi_ea"  ~ "Academic efficacy",
      Variable == "mbi_ex"  ~ "Emotional exhaustion", 
      Variable == "qcae_aff" ~ "QCAE affective",
      Variable == "qcae_cog"  ~ "QCAE cognitive",
      Variable == "jspe"  ~ "JSPE-S",
      TRUE                     ~ Variable
    )
  )
```
```{r warning=FALSE,message=FALSE}
final_table1_clean %>%
  kable(
    caption = "The results of reproducing descriptive statistics (N = 886)",
    col.names = c("Variable", "Mean (SD)", "Percent"),
    digits = c(NA, 2, 2)
  ) %>%
  kable_styling(latex_options = c("H", "scale_down"), font_size = 9,full_width = FALSE)

```
To replicate the findings in Table 2 of the original paper regarding the effects of year and gender on mental health and burnout, we built linear regression models for five mental health and burnout indicators (CES-D depression, STAI anxiety, and three MBI dimensions) and five empathy indicators (JSPE-S, QCAE, AMSP, GERT-S). Standardized $\beta$ coefficients were used to assess the effects of year (relative to B1) and gender (female vs. male) on each outcome. Full results are in the appendix (Table4); this section presents a visualization of the replication results (see figure below).

The figure shows that most mental health indicators (e.g., depressive symptoms, anxiety, emotional exhaustion) are negatively associated with higher years, suggesting improved mental states over time. Female students show positive standardized $\beta$s for depression, anxiety, and emotional exhaustion, indicating more reported negative emotional experiences. Females also score significantly higher on nearly all empathy dimensions, with the largest difference in QCAE affective empathy ($\beta = 0.37$*** ).

These results are consistent with the conclusions in Table 2 of the original paper, supporting the authors’ interpretation that higher-year students have better mental health and female students show higher empathy. Overall, the regression analysis was successfully replicated.
```{r fig:beta-bar, echo=FALSE, message=FALSE, fig.width=14, fig.height=10,warning=FALSE,out.extra='keepaspectratio=true, width=\\textwidth', fig.cap="Standardized regression coefficients (beta) by outcome, with significance stars"}

# 1) Prepare plotting data: extract numeric beta and keep full 'beta' string for labels
plot_df <- final_table2 %>%
  mutate(
    beta_num = as.numeric(str_extract(β, "-?\\d+\\.\\d+")),   # numeric part of beta
    label    = β,                                             # full beta+stars
    term     = factor(term, levels = c("yearB2","yearB3",
                                       "yearM1","yearM2",
                                       "yearM3","sexFemale")))%>%
  mutate(
    outcome = case_when(
      outcome == "stai_t"  ~ "Anxiety", 
      outcome == "cesd" ~ "Depressive symptoms",
      outcome == "amsp"  ~ "AMSP",
      outcome == "erec_mean"  ~ "GERT-S", 
      outcome == "mbi_cy" ~ "Cynicism",
      outcome == "mbi_ea"  ~ "Academic efficacy",
      outcome == "mbi_ex"  ~ "Emotional exhaustion", 
      outcome == "qcae_aff" ~ "QCAE affective",
      outcome == "qcae_cog"  ~ "QCAE cognitive",
      outcome == "jspe"  ~ "JSPE-S",
      TRUE                     ~ outcome
    ))

# 2) Draw bar plot, faceting by outcome
ggplot(plot_df, aes(x = term, y = beta_num)) +
  geom_col(fill = "steelblue") +
  geom_text(aes(label = label),
            vjust = ifelse(plot_df$beta_num >= 0, -0.3,  1.3),
            size = 3) +
  facet_wrap(~ outcome, scales = "free_x", nrow = 2, strip.position = "top") +
  labs(
    x        = NULL,
    y        = "Standardized beta",
    title    = "Standardized Regression Coefficients by Outcome",
    subtitle = "Bar height = beta value; stars indicate significance (* p<0.05, ** p<0.01, *** p<0.001)"
  ) +
  theme_bw(base_size = 12) +
  theme(
    axis.text.x      = element_text(angle = 45, hjust = 1),
    strip.background = element_rect(fill = "grey95"),
    strip.text       = element_text(face = "bold")
  )

# Save
ggsave("figures/beta_barplot_by_outcome.png", width = 14, height = 10)
```
To replicate the regression analyses in Table 3 of the original study, we built linear models for five mental health and burnout outcomes (CES-D, STAI, and three MBI dimensions), using five empathy measures (JSPE-S, QCAE cognitive, QCAE affective, AMSP, GERT-S) as predictors. Year and gender were controlled, consistent with the original setup.

The figure below shows the standardized $\beta$ coefficients and effect sizes ($\eta^2$). Color indicates the direction and magnitude of $\beta$; text labels show exact $\beta$ values with significance levels (* p<.05, ** p<.01, *** p<.001). The full regression table with standard errors, F-statistics, and R² is in the appendix (Table5).

The results closely replicate the core findings of the original study: 1. QCAE affective empathy is significantly related to all outcomes, with positive $\beta$ values, indicating students with higher affective empathy report more mental health problems, though effect sizes are small ($\eta^2$ < .05). 2. In contrast, AMSP behavioral empathy predicts lower depression and anxiety, and higher academic efficacy (i.e., less burnout), with slightly stronger effects (max $\eta^2$ = .05). 3. JSPE-S and QCAE cognitive empathy are significantly linked to reduced anxiety and higher academic efficacy, but effects are weaker. 4. GERT-S emotion recognition shows no significant relation with any outcome.
```{r heatmap-beta-eta2, echo=FALSE, fig.cap="Heatmap of standardized beta (top) and eta2 (bottom) for the empathy–outcome regressions", fig.height=8, fig.width=6}
plot_df3 <- final_table3 %>%
  rename(beta = estimate) %>%
  mutate(
    outcome = factor(outcome,
      levels = c("cesd", "stai_t", "mbi_ex", "mbi_cy", "mbi_ea"),
      labels = c("Depressive\nsymptoms",
                 "Anxiety",
                 "Emotional\nexhaustion",
                 "Cynicism",
                 "Academic\nefficacy")
    ),
    empathy = factor(empathy,
      levels = c("jspe", "qcae_cog", "qcae_aff", "amsp", "erec_mean"),
      labels = c("JSPE-S",
                 "QCAE-Cognitive",
                 "QCAE-Affective",
                 "AMSP",
                 "GERT-S")
    )
  ) %>%
  select(empathy, outcome, beta, p_stars, eta2) %>%
  pivot_longer(
    cols = c(beta, eta2),
    names_to  = "metric",
    values_to = "value"
  ) %>%
  mutate(
    label = case_when(
      metric == "beta" ~ sprintf("%0.2f%s", value, ifelse(is.na(p_stars),"",p_stars)),
      metric == "eta2" ~ sprintf("%0.2f", value)
    ),
    metric = factor(metric, levels = c("beta", "eta2"),
      labels = c("Standardized beta", "eta2")
    )
  )

ggplot(plot_df3, aes(x = outcome, y = empathy, fill = value)) +
  geom_tile(color = "white") +
  geom_text(aes(label = label), size = 3) +
  scale_fill_gradient2(
    name = NULL,
    low  = "firebrick", mid = "white", high = "steelblue",
    midpoint = 0
  ) +
  facet_wrap(~ metric, ncol = 1, scales = "free") +
  labs(
    x = NULL, y = NULL
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position   = "bottom",
    strip.text        = element_text(face = "bold", size = 12, margin=margin(4,0,4,0)),
    axis.text.x       = element_text(angle = 0, vjust = 0.5),
    panel.grid.major  = element_blank(),
    panel.grid.minor  = element_blank()
  )
# Save
ggsave("figures/table3_heatplot_beta_eta.png", width = 7, height = 10)
```
\clearpage
To replicate the descriptive analysis of CES-D depression risk in the original study, we classified the sample using gender-specific cut-offs (male \(\ge 16\), female \(\ge 21\)). About 40.98% of students in the replication sample are at clinical depression risk, close to the 40.18% reported in the original. A breakdown by year shows a general decline in risk across years, closely matching the original trend. The table below compares depression risk proportions by year:
```{r warning=FALSE, message=FALSE}
# Original reported percentages from the paper
original_pct <- c(51.02, 45.93, 39.16, 34.96, 33.07, 24.78)
year_labels <- c("B1", "B2", "B3", "M1", "M2", "M3")

# Assuming final_eta is already available
compare_cesd <- final_eta %>%
  select(year, positive_pct) %>%
  mutate(
    `Original (%)` = original_pct,
    `Difference (%)` = round(positive_pct - original_pct, 2)
  ) %>%
  rename(`Year` = year, `Reproduced (%)` = positive_pct)

# Save
write_csv(compare_cesd, "figures/table_compare_cesd.csv")

# Display table
kable(compare_cesd,
      caption = "Comparison of CES-D clinical risk percentages by year (Reproduction vs. Original study)",
      align = "c") %>%
  kable_styling(latex_options = c("striped", "scale_down","H"),
                full_width = FALSE,
                position = "center")

```
# Discussion and Improvement suggestions
The replication process in this study went smoothly overall, thanks to the original paper’s detailed model descriptions, data access, and preprocessing steps, showing good reproducibility and research transparency. Although I used a different analysis tool (R instead of Stata), I was still able to successfully replicate the key regression results by following the publicly available data and methods, demonstrating the robustness of the original findings. This kind of cross-platform reproducibility is valuable in medical education research, increasing confidence in future intervention design and practical application.

Several key technical points emerged during the replication. For example, when fitting initial linear models with unstandardized data, the resulting $\beta$ coefficients differed from the original, although effect sizes ($\eta^2$) and F-values remained consistent. Upon further review, I confirmed that the original study used standardized $\beta$ coefficients. I therefore applied `parameters::standardize_parameters(method = "basic")` in R to standardize the results. This method does not transform the data directly but uses the following formula to adjust coefficients based on the ratio of standard deviations:
\[
\beta^* = \hat{\beta} \cdot \frac{\text{SD}(x)}{\text{SD}(y)}
\]
This approach is logically equivalent to Stata’s `, beta` option. After standardization, the $\beta$ values matched the original exactly, confirming the authors’ method and highlighting the importance of coefficient definitions in cross-platform replication.

For the CES-D positive rate (depression risk), I followed the gender-specific cut-offs noted in the paper (16 for males, 21 for females), and tested both “\(\ge\)” and “\(>\)” thresholds. In both cases, the calculated rate differed from the original by about 1%, though the trend was fully consistent. I suspect this difference may stem from how the authors handled scores at the cut-off (exactly 16 or 21), which was not explained in the paper. One possibility is that decisions were made based on clinical judgment or questionnaire logic; another is that they used adjusted or standardized scores (e.g., Z-scores, T-scores, scale scores, or totals excluding some items) rather than raw CES-D totals. As the paper lacks detail, such differences likely reflect unobservable decisions rather than replication error.

Building on the replication, I also optimized the result presentation by adding visual outputs. Compared to tables alone, bar plots and heatmaps more clearly show the direction and significance of standardized $\beta$ coefficients, and allow more efficient comparison across models. This improves readability and communication, aligning with current expectations for interpretability and user experience in research reporting.

# Reflection and Ethical Considerations
The data used in this replication come from an ethically approved project (approved by the Ethics Committee of the Canton of Vaud, Switzerland, No. 2020-02474). The original research team ensured participants’ informed rights and autonomy through appropriate procedures in recruitment, compensation, and informed consent. In this replication, I also followed ethical standards by using only public data, avoiding access to raw sensitive scores, and conducting analyses strictly based on the original cut-off values.

In reflection, we believe that if the original study had provided more details on scale scoring (e.g., CES-D item scores and processing logic), it would improve the transparency and accuracy of cut-off determinations. During preprocessing, the original study excluded non-binary participants (n = 6). While this aligns with conventional modeling, it raises questions about inclusivity. Future research could consider alternative handling methods for rare categories (e.g., category merging, small-sample modeling, or weighted estimates) to enhance representativeness.

In addition, the current models are all main-effect models. Future studies could explore interaction effects, multiverse analysis, or multilevel modeling to better capture complex relationships and improve explanatory power.


# Appendix A.
```{r appendix-table1, echo=FALSE, message=FALSE, warning=FALSE,results="asis"}
final_table1 %>%
  kable( longtable = TRUE,
    caption = "Full descriptive statistics for all categorical variables (replication)",
    col.names = c("Variable", "Mean (SD)", "Percent")
  ) %>%
  kable_styling(latex_options = c("hold_position", "scale_down"), font_size = 10)
```
```{r appendix-table2, echo=FALSE, message=FALSE, warning=FALSE, results="asis"}

# Render it into a large table and insert group_rows between each outcome group
kbl(final_table2 %>% select(-outcome),
    booktabs = TRUE,
    longtable = TRUE,
    caption = "Regression results by outcome (replication)",
    col.names = c("Predictor", "beta", "SE", "eta2", "F", "R²"),
    digits = c(NA, 2, 2, 2, 2, 2)
  ) %>%
  # Group by outcome and insert titles
  group_rows(
    "CES-D (Depressive symptoms)",
    1,
    sum(final_table2$outcome == "cesd")
  ) %>%
  group_rows(
    "STAI-T (Anxiety)",
    sum(final_table2$outcome == "cesd") + 1,
    sum(final_table2$outcome %in% c("cesd","stai_t"))
  ) %>%
  group_rows(
    "MBI-EX (Emotional exhaustion)",
    sum(final_table2$outcome %in% c("cesd","stai_t")) + 1,
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex"))
  ) %>%
  group_rows(
    "MBI-CY (Cynicism)",
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex")) + 1,
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex","mbi_cy"))
  ) %>%
  group_rows(
    "MBI-EA (Academic efficacy)",
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex","mbi_cy")) + 1,
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex","mbi_cy","mbi_ea"))
  ) %>%
  group_rows(
    "JSPE-S",
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex","mbi_cy","mbi_ea")) + 1,
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex","mbi_cy","mbi_ea","jspe"))
  ) %>%
  group_rows(
    "QCAE-Cognitive",
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex","mbi_cy","mbi_ea","jspe"))+1,
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex","mbi_cy","mbi_ea","jspe","qcae_cog"))
  ) %>%
  group_rows(
    "QCAE-Affective",
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex","mbi_cy","mbi_ea","jspe","qcae_cog"))+1,
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex","mbi_cy","mbi_ea","jspe","qcae_cog","qcae_aff"))
  ) %>%
  group_rows(
    "AMSP",
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex","mbi_cy","mbi_ea","jspe","qcae_cog","qcae_aff"))+1,
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex","mbi_cy","mbi_ea","jspe","qcae_cog","qcae_aff","amsp"))
  ) %>%
  group_rows(
    "GERT-S",
    sum(final_table2$outcome %in% c("cesd","stai_t","mbi_ex","mbi_cy","mbi_ea","jspe","qcae_cog","qcae_aff","amsp"))+1,
    nrow(final_table2)
  ) %>%
  kable_styling(
    latex_options = c("H", "scale_down","repeat_header"),
    font_size = 11,
    position = "center"
  )
```
```{r appendix-table3, warning=FALSE, message=FALSE,echo=FALSE, results='asis'}
table3_appendix <- final_table3 %>%
  rename(
    Empathy       = empathy,
    Outcome       = outcome,
    Beta          = estimate,
    `p stars`     = p_stars,
    SE            = std.error,
    `η² (partial)`= eta2,
    `F statistic` = F_stat,
    `R²`          = R2
  ) %>%
  mutate(
    Empathy = recode(Empathy,
      jspe      = "JSPE-S",
      qcae_cog  = "QCAE-Cognitive",
      qcae_aff  = "QCAE-Affective",
      amsp      = "AMSP",
      erec_mean = "GERT-S"
    ),
    Outcome = recode(Outcome,
      cesd    = "Depressive symptoms",
      stai_t  = "Anxiety",
      mbi_ex  = "Emotional exhaustion",
      mbi_cy  = "Cynicism",
      mbi_ea  = "Academic efficacy"
    )
  )

kable(
  table3_appendix,
  booktabs     = TRUE,
  longtable = TRUE,
  caption      = "Relationship between empathy, mental health, and burnout (replication).",
  align        = c("l", "l", "r", "l", "r", "r", "r", "r"),
  digits       = c(0, 0, 2, 0, 2, 2, 2, 2)  
) %>%
  kable_styling(
    latex_options = c("repeat_header", "H","scale_down"),
    font_size = 9
  ) 

```
# References